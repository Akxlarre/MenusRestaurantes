---
interface Props {
    id: string;
    name_es: string;
    name_zh: string;
    price: number;
    is_available: boolean;
}

const { id, name_es, name_zh, price, is_available } = Astro.props;
---

<!-- Card con colores accesibles -->
<a
    href={`/menu/${id}`}
    class={`menu-item-card group ${!is_available ? "opacity-50" : ""}`}
    data-product-id={id}
    data-available={is_available.toString()}
    data-astro-prefetch="hover"
>
    <div class="flex items-center justify-between gap-6 relative">
        <!-- Indicador visual izquierdo -->
        <div class="indicator-line"></div>

        <!-- Contenido del plato -->
        <div class="flex-1 min-w-0">
            <!-- Nombre en caracteres CJK con color accesible (contraste 6:1) -->
            <p class="text-xs font-noto-serif text-gris mb-1.5 tracking-wide">
                {name_zh}
            </p>

            <!-- Título en español -->
            <h3
                class="text-xl md:text-2xl font-playfair font-semibold text-sumi-ink group-hover:text-matcha-text transition-colors duration-300 leading-tight"
            >
                {name_es}
            </h3>

            <!-- Contenedor para badge de agotado (controlado por realtime) -->
            <span 
                class="unavailable-badge mt-2 text-xs text-arroz font-inter font-semibold px-2 py-0.5 bg-agotado rounded"
                style={is_available ? "display: none;" : "display: inline-block;"}
            >
                Agotado
            </span>
        </div>

        <!-- Precio y acción -->
        <div class="flex flex-col items-end gap-2 flex-shrink-0">
            <div
                class="text-2xl md:text-3xl font-inter font-bold text-sumi-ink whitespace-nowrap tabular-nums"
            >
                ${price.toLocaleString("es-CL")}
            </div>
            <!-- Link con color accesible (contraste 7:1) -->
            <div
                class="flex items-center gap-1.5 text-xs font-inter font-medium text-matcha-text group-hover:text-matcha-dark group-hover:translate-x-1 transition-all duration-300"
            >
                <span>Ver detalles</span>
                <svg
                    class="w-4 h-4"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                    stroke-width="2"
                >
                    <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        d="M9 5l7 7-7 7"></path>
                </svg>
            </div>
        </div>
    </div>
</a>

<style>
    .menu-item-card {
        display: block;
        padding: 1.75rem 2rem;
        background: transparent;
        border: 1.5px solid rgba(74, 107, 62, 0.2);
        border-radius: 12px;
        position: relative;
        overflow: hidden;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .menu-item-card::before {
        content: "";
        position: absolute;
        inset: 0;
        background: linear-gradient(
            90deg,
            transparent,
            rgba(74, 107, 62, 0.08),
            transparent
        );
        transform: translateX(-100%);
        transition: transform 0.6s ease;
    }

    .menu-item-card:hover::before {
        transform: translateX(100%);
    }

    .menu-item-card:hover {
        transform: translateY(-2px);
        border-color: var(--matcha-dark);
        box-shadow:
            0 8px 32px rgba(74, 107, 62, 0.15),
            -4px 0 0 0 var(--matcha-dark);
        background: rgba(255, 255, 255, 0.3);
    }

    .indicator-line {
        position: absolute;
        left: -2px;
        top: 50%;
        transform: translateY(-50%) scaleY(0);
        width: 4px;
        height: 60%;
        background: var(--matcha-dark);
        border-radius: 0 4px 4px 0;
        transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .menu-item-card:hover .indicator-line {
        transform: translateY(-50%) scaleY(1);
    }

    /* Responsive */
    @media (max-width: 640px) {
        .menu-item-card {
            padding: 1.25rem 1.5rem;
        }
    }
</style>
